This enhanced version from file content